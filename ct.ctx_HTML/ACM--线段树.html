<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>线段树</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="2019.html">2019</a></p>

<ol>
<li><a href="2019--March.html">March</a></li>
<ol>
<li><a href="2019--March--11_Mon.html">11 Mon</a></li>
<li><a href="2019--March--12.html">12</a></li>
<li><a href="2019--March--13.html">13</a></li>
<li><a href="2019--March--14.html">14</a></li>
<li><a href="2019--March--15.html">15</a></li>
<li><a href="2019--March--16_Sat.html">16 Sat</a></li>
<li><a href="2019--March--17_Sun.html">17 Sun</a></li>
<li><a href="2019--March--19.html">19</a></li>
<li><a href="2019--March--20_Wed.html">20 Wed</a></li>
<li><a href="2019--March--21_Thu.html">21 Thu</a></li>
<li><a href="2019--March--22_Fri.html">22 Fri</a></li>
<li><a href="2019--March--23_Sat.html">23 Sat</a></li>
<li><a href="2019--March--24_Sun.html">24 Sun</a></li>
<li><a href="2019--March--25_Mon.html">25 Mon</a></li>
<li><a href="2019--March--26_Tue.html">26 Tue</a></li>
<li><a href="2019--March--27_Wed.html">27 Wed</a></li>
<li><a href="2019--March--29_Fri.html">29 Fri</a></li>
<li><a href="2019--March--31_Sun.html">31 Sun</a></li>
</ol>
<li><a href="2019--April.html">April</a></li>
<ol>
<li><a href="2019--April--01_Mon.html">01 Mon</a></li>
<li><a href="2019--April--08_Mon.html">08 Mon</a></li>
<li><a href="2019--April--09_Tue.html">09 Tue</a></li>
<li><a href="2019--April--10_Wed.html">10 Wed</a></li>
<li><a href="2019--April--11_Thu.html">11 Thu</a></li>
<li><a href="2019--April--12_Fri.html">12 Fri</a></li>
<li><a href="2019--April--13_Sat.html">13 Sat</a></li>
<li><a href="2019--April--14_Sun.html">14 Sun</a></li>
<li><a href="2019--April--15_Mon.html">15 Mon</a></li>
<li><a href="2019--April--16_Tue.html">16 Tue</a></li>
<li><a href="2019--April--17_Wed.html">17 Wed</a></li>
<li><a href="2019--April--19_Fri.html">19 Fri</a></li>
<li><a href="2019--April--20_Sat.html">20 Sat</a></li>
<li><a href="2019--April--21_Sun.html">21 Sun</a></li>
<li><a href="2019--April--23_Tue.html">23 Tue</a></li>
<li><a href="2019--April--26_Fri.html">26 Fri</a></li>
<li><a href="2019--April--27_Sat.html">27 Sat</a></li>
<li><a href="2019--April--28_Sun.html">28 Sun</a></li>
</ol>
<li><a href="2019--May.html">May</a></li>
<ol>
<li><a href="2019--May--04_Sat.html">04 Sat</a></li>
<li><a href="2019--May--06_Mon.html">06 Mon</a></li>
<li><a href="2019--May--07_Tue.html">07 Tue</a></li>
<li><a href="2019--May--08_Wed.html">08 Wed</a></li>
<li><a href="2019--May--09_Thu.html">09 Thu</a></li>
<li><a href="2019--May--10_Fri.html">10 Fri</a></li>
</ol>
</ol>
<p><a href="ACM.html">ACM</a></p>

<ol>
<li><a href="ACM--大整数.html">大整数</a></li>
<li><a href="ACM--DP.html">DP</a></li>
<ol>
<li><a href="ACM--DP--UVA12563.html">UVA12563</a></li>
<li><a href="ACM--DP--UVA11400.html">UVA11400</a></li>
<li><a href="ACM--DP--UVA11584.html">UVA11584</a></li>
<li><a href="ACM--DP--UVA1625.html">UVA1625</a></li>
<li><a href="ACM--DP--被三整除的子序列_牛客-21302.html">被三整除的子序列 牛客-21302</a></li>
<li><a href="ACM--DP--help_jimmy_poj-1661.html">help jimmy poj-1661</a></li>
<li><a href="ACM--DP--LCS_poj-1458.html">LCS poj-1458</a></li>
<li><a href="ACM--DP--Jury_compromise_poj-1015.html">Jury compromise poj-1015</a></li>
</ol>
<li><a href="ACM--图.html">图</a></li>
<li><a href="ACM--线段树.html">线段树</a></li>
<li><a href="ACM--数论.html">数论</a></li>
<li><a href="ACM--其他.html">其他</a></li>
<li><a href="ACM--2019年ccpc校选赛.html">2019年ccpc校选赛</a></li>
<li><a href="ACM--Codeforces_Round_~554_(Div._2).html">Codeforces Round #554 (Div. 2)</a></li>
</ol>
<p><a href="PWN.html">PWN</a></p>

<ol>
<li><a href="PWN--从0开始认识.html">从0开始认识</a></li>
<li><a href="PWN--准备工作.html">准备工作</a></li>
<li><a href="PWN--扫描和嗅探.html">扫描和嗅探</a></li>
</ol>
<p><a href="web前端.html">web前端</a></p>

<ol>
<li><a href="web前端--HTML.html">HTML</a></li>
<ol>
<li><a href="web前端--HTML--表单类.html">表单类</a></li>
<li><a href="web前端--HTML--表格.html">表格</a></li>
</ol>
<li><a href="web前端--CSS.html">CSS</a></li>
<ol>
<li><a href="web前端--CSS--语法.html">语法</a></li>
<li><a href="web前端--CSS--CSS创建.html">CSS创建</a></li>
<li><a href="web前端--CSS--backgrounds背景.html">backgrounds背景</a></li>
<li><a href="web前端--CSS--Text文本.html">Text文本</a></li>
<li><a href="web前端--CSS--fonts字体.html">fonts字体</a></li>
<li><a href="web前端--CSS--Border边框.html">Border边框</a></li>
<li><a href="web前端--CSS--表格边框.html">表格边框</a></li>
</ol>
</ol>
<p><a href="后端开发.html">后端开发</a></p>

<ol>
<li><a href="后端开发--Java.html">Java</a></li>
<ol>
<li><a href="后端开发--Java--安装和使用.html">安装和使用</a></li>
<li><a href="后端开发--Java--装箱和拆箱.html">装箱和拆箱</a></li>
<li><a href="后端开发--Java--字符串.html">字符串</a></li>
<li><a href="后端开发--Java--继承.html">继承</a></li>
<li><a href="后端开发--Java--异常处理.html">异常处理</a></li>
</ol>
<li><a href="后端开发--C++.html">C++</a></li>
<ol>
<li><a href="后端开发--C++--类.html">类</a></li>
<li><a href="后端开发--C++--运算符重载.html">运算符重载</a></li>
<li><a href="后端开发--C++--数据结构.html">数据结构</a></li>
</ol>
</ol>
<p><a href="Linux运维.html">Linux运维</a></p>

<ol>
<li><a href="Linux运维--shortcuts.html">shortcuts</a></li>
<ol>
<li><a href="Linux运维--shortcuts--vim.html">vim</a></li>
<li><a href="Linux运维--shortcuts--linux_terminal.html">linux terminal</a></li>
<li><a href="Linux运维--shortcuts--xfceThunar.html">xfceThunar</a></li>
<li><a href="Linux运维--shortcuts--rar.html">rar</a></li>
</ol>
<li><a href="Linux运维--安装virtualbox虚拟机.html">安装virtualbox虚拟机</a></li>
<li><a href="Linux运维--安装TIM.html">安装TIM</a></li>
<li><a href="Linux运维--使用shadowsocks-qt5.html">使用shadowsocks-qt5</a></li>
<li><a href="Linux运维--文件管理方法修改.html">文件管理方法修改</a></li>
<li><a href="Linux运维--firefox_update_and_adds-on_can't_use.html">firefox update and adds-on can't use</a></li>
</ol>
<p><a href="云计算和大数据.html">云计算和大数据</a></p>

<p><a href="数据库.html">数据库</a></p>

<ol>
<li><a href="数据库--Mariadb.html">Mariadb</a></li>
</ol>
<p><a href="信息安全.html">信息安全</a></p>

<p><a href="其他技术.html">其他技术</a></p>

<p><a href="Git.html">Git</a></p>

<p><a href="JavaWeb.html">JavaWeb</a></p>

<ol>
<li><a href="JavaWeb--Web前端.html">Web前端</a></li>
<ol>
<li><a href="JavaWeb--Web前端--HTML.html">HTML</a></li>
<li><a href="JavaWeb--Web前端--CSS.html">CSS</a></li>
</ol>
<li><a href="JavaWeb--Web后台.html">Web后台</a></li>
<ol>
<li><a href="JavaWeb--Web后台--session.html">session</a></li>
<li><a href="JavaWeb--Web后台--JSP.html">JSP</a></li>
<ol>
<li><a href="JavaWeb--Web后台--JSP--JSP语法.html">JSP语法</a></li>
</ol>
<li><a href="JavaWeb--Web后台--开发环境安装及配置.html">开发环境安装及配置</a></li>
<li><a href="JavaWeb--Web后台--JDBC数据库连接.html">JDBC数据库连接</a></li>
<li><a href="JavaWeb--Web后台--数据库连接池.html">数据库连接池</a></li>
<li><a href="JavaWeb--Web后台--CommonsDbUtils类库.html">CommonsDbUtils类库</a></li>
</ol>
<li><a href="JavaWeb--webSocket.html">webSocket</a></li>
</ol></div>
<div class="page"><h1><b><u>线段树</u></b></h1><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">//my&nbsp;WA&nbsp;four&nbsp;times...after&nbsp;I&nbsp;know&nbsp;answer</span><br /><span style="color:#0088ff;font-weight:400">/*<br />#include&lt;bits/stdc++.h&gt;<br />using&nbsp;namespace&nbsp;std;<br /><br />#define&nbsp;ffor(i,&nbsp;a,&nbsp;b)&nbsp;for(int&nbsp;i&nbsp;=&nbsp;(a);&nbsp;i&lt;(b);&nbsp;i++)<br />typedef&nbsp;long&nbsp;long&nbsp;ll;<br />const&nbsp;int&nbsp;maxn=3e5+3;<br /><br />struct&nbsp;segmentTree{<br />	ll&nbsp;value,&nbsp;mark;<br />}tree[maxn&lt;&lt;4];<br />ll&nbsp;ql,&nbsp;qr,&nbsp;qx;<br /><br />void&nbsp;build(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r);<br />void&nbsp;pushDown(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r);<br />ll&nbsp;query(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r);<br />void&nbsp;update(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r);<br /><br />int&nbsp;main(){<br />	ios::sync_with_stdio(false);<br />	int&nbsp;n,&nbsp;m,&nbsp;chose;&nbsp;cin&nbsp;&gt;&gt;n&nbsp;&gt;&gt;m;<br /><br />	while(m--){<br />		cin&nbsp;&gt;&gt;chose&nbsp;&gt;&gt;ql&nbsp;&gt;&gt;qr;<br />		if(chose==1){<br />			cin&nbsp;&gt;&gt;qx;<br />			update(1,&nbsp;1,&nbsp;n);<br />		}else{<br />			cout&nbsp;&lt;&lt;query(1,&nbsp;1,&nbsp;n)&nbsp;&lt;&lt;endl;<br />		}<br />	}<br />	return&nbsp;0;<br />}<br /><br />void&nbsp;build(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r){<br />	if(l&gt;=r)&nbsp;{&nbsp;tree[o].value=l;&nbsp;return;}<br />	<br />	int&nbsp;m=(l+r)&gt;&gt;1;<br />	build(o&lt;&lt;1,&nbsp;l,&nbsp;m);<br />	build(o&lt;&lt;1|1,&nbsp;m+1,&nbsp;r);<br />	tree[o].value&nbsp;=&nbsp;tree[o&lt;&lt;1].value+tree[o&lt;&lt;1|1].value;<br />}<br />void&nbsp;pushDown(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r){<br />	if(tree[o].mark==0)&nbsp;return;<br />	<br />	int&nbsp;lc=o&lt;&lt;1,&nbsp;rc=lc|1;<br />	int&nbsp;m&nbsp;=(l+r)&gt;&gt;1;<br />	tree[lc].value+=tree[o].mark*(m+1-l);//has&nbsp;get&nbsp;WA&nbsp;here<br />	tree[rc].value+=tree[o].mark*(r-m);//has&nbsp;get&nbsp;WA&nbsp;here<br />	tree[lc].mark+=tree[o].mark;<br />	tree[rc].mark+=tree[o].mark;<br />	tree[o].mark=0;<br />}<br />ll&nbsp;query(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r){<br />	if(ql&gt;r&nbsp;||&nbsp;qr&lt;l)&nbsp;return&nbsp;0;<br />	if(ql&lt;=l&nbsp;&amp;&amp;&nbsp;qr&gt;=r)&nbsp;{return&nbsp;tree[o].value;}<br /><br />	pushDown(o,&nbsp;l,&nbsp;r);<br />	int&nbsp;m=(l+r)&gt;&gt;1;<br />	return&nbsp;query(o&lt;&lt;1,&nbsp;l,&nbsp;m)+query(o&lt;&lt;1|1,&nbsp;m+1,&nbsp;r);<br />}<br />void&nbsp;update(int&nbsp;o,&nbsp;int&nbsp;l,&nbsp;int&nbsp;r){<br />	if(ql&gt;r&nbsp;||&nbsp;qr&lt;l)&nbsp;return;<br />	if(ql&lt;=l&nbsp;&amp;&amp;&nbsp;qr&gt;=r)&nbsp;{tree[o].value+=qx*(r-l+1);tree[o].mark+=qx;&nbsp;return;}<br /><br />	pushDown(o,&nbsp;l,&nbsp;r);<br />	int&nbsp;m=(l+r)&gt;&gt;1;<br />	update(o&lt;&lt;1,&nbsp;l,&nbsp;m);<br />	update(o&lt;&lt;1|1,&nbsp;m+1,&nbsp;r);<br />	tree[o].value=tree[o&lt;&lt;1].value+tree[o&lt;&lt;1|1].value;<br />}<br />*/</span><br /><br /><span style="color:#0088ff;font-weight:400">//------------------------------------我是可爱的分割线---------------------------------------------------------------------------</span><br /><br /><span style="color:#0088ff;font-weight:400">//ORZ&nbsp;code&nbsp;in&nbsp;'C',it's&nbsp;very&nbsp;short,&nbsp;but&nbsp;I&nbsp;can't&nbsp;understand&nbsp;it</span><br /><span style="color:#7f0044;font-weight:700">#include&nbsp;&lt;bits/stdc++.h&gt;</span><br /><span style="color:#ff9d00;font-weight:700">using</span>&nbsp;<span style="color:#ff9d00;font-weight:700">namespace</span>&nbsp;std;<br /><br />int64_t&nbsp;tree1[<span style="color:#ff0044;font-weight:400">300005</span>],tree2[<span style="color:#ff0044;font-weight:400">300005</span>];<br /><span style="color:#7f0044;font-weight:400">inline</span>&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;lowbit(<span style="color:#7f0044;font-weight:400">int</span>&nbsp;x)&nbsp;{<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;x&amp;-x;}<br /><span style="color:#7f0044;font-weight:400">int</span>&nbsp;n,&nbsp;m;<br /><br /><span style="color:#7f0044;font-weight:400">void</span>&nbsp;update(<span style="color:#7f0044;font-weight:400">int</span>&nbsp;p,&nbsp;int64_t&nbsp;x)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;int64_t&nbsp;pos&nbsp;=&nbsp;p;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>(p&nbsp;&lt;=&nbsp;n)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tree1[p]&nbsp;+=&nbsp;x;&nbsp;tree2[p]&nbsp;+=&nbsp;pos*x;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;+=&nbsp;lowbit(p);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />int64_t&nbsp;query(<span style="color:#7f0044;font-weight:400">int</span>&nbsp;p)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;int64_t&nbsp;pos&nbsp;=&nbsp;p;<br />&nbsp;&nbsp;&nbsp;&nbsp;int64_t&nbsp;ans&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">while</span>(p)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;+=&nbsp;(pos+<span style="color:#ff0044;font-weight:400">1</span>)*tree1[p]-tree2[p];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;-=&nbsp;lowbit(p);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;ans;<br />}<br /><br /><span style="color:#7f0044;font-weight:400">int</span>&nbsp;main()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;scanf(<span style="color:#3ad900;font-weight:400">"%d%d"</span>,&amp;n,&amp;m);<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">for</span>(<span style="color:#7f0044;font-weight:400">int</span>&nbsp;i&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">0</span>;&nbsp;i&nbsp;&lt;&nbsp;m;&nbsp;++i)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;op,&nbsp;l&nbsp;,&nbsp;r;&nbsp;scanf(<span style="color:#3ad900;font-weight:400">"%d%d%d"</span>,&amp;op,&amp;l,&amp;r);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(op&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">1</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#7f0044;font-weight:400">int</span>&nbsp;x;&nbsp;scanf(<span style="color:#3ad900;font-weight:400">"%d"</span>,&amp;x);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update(l,&nbsp;x);&nbsp;update(r+<span style="color:#ff0044;font-weight:400">1</span>,&nbsp;-x);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">if</span>(op&nbsp;==&nbsp;<span style="color:#ff0044;font-weight:400">2</span>)<br />		printf(<span style="color:#3ad900;font-weight:400">"%lld\n"</span>,query(r)-query(l-<span style="color:#ff0044;font-weight:400">1</span>));<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#ff0044;font-weight:400">0</span>;<br />}</div></div></div></div>
</body></html>